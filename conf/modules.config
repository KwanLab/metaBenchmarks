/*
========================================================================================
    Config file for defining DSL2 per module options and publishing paths
========================================================================================
    Available keys to override module options:
        ext.args            = Additional arguments appended to command in module.
        ext.args2           = Second set of arguments appended to command in module (multi-tool modules).
        ext.args3           = Third set of arguments appended to command in module (multi-tool modules).
        ext.prefix          = File name prefix for output files.
----------------------------------------------------------------------------------------
*/


process {
    // Write out to directories named after the workflow/process
    withName: 'FASTQC|MULTIQC|AUTOMETA_V1_BINNING|AUTOMETA_V1_CALCULATE_READ_COVERAGE|AUTOMETA_V1_UNCLUSTERED_RECRUITMENT|AUTOMETA_V1_MAKE_TAXONOMY_TABLE|MYCC|VAMB|METABAT2|JGI_SUMMARIZE_BAM_CONTIG_DEPTHS|MINIMAP2|MMSEQS2_CREATEDB|MMSEQS2_CREATETAXDB|MMSEQS2_DATABASES|MMSEQS2_TAXONOMY|MMSEQS2_CREATETSV' {
        publishDir = [
            // Save output files to a folder named after the Nextflow process
            path: { "${params.single_outdir}/${task.process.tokenize(':').toLowerCase().join("/")}" },
            mode: 'copy',
            saveAs: { filename -> filename.equals('versions.yml') ? null : filename }
        ]
    }
    withName: 'DOWNLOAD_KRAKEN' {
        storeDir = "${params.kraken2_db}"
    }

    withName: FASTQC {
        ext.args   = "--quiet"
    }
    withName: MULTIQC {
        ext.args   = ""
    }
    withName: AUTOMETA_V1_BINNING {
        ext.args   = "--length_cutoff 3000"
    }
    withName: AUTOMETA_V1_CALCULATE_READ_COVERAGE {
        ext.args   = ""
    }
    withName: AUTOMETA_V1_UNCLUSTERED_RECRUITMENT {
        ext.args   = ""
    }
    withName: AUTOMETA_V1_MAKE_TAXONOMY_TABLE {
        ext.args   = "--length_cutoff 3000"
    }
    withName: AUTOMETA_COVERAGE {
        ext.args   = ""
    }
    withName: AUTOMETA_BENCHMARK_BINNING {
        ext.args   = ""
    }
    withName: AUTOMETA_BENCHMARK_TAXON_PROFILING {
        ext.args   = ""
    }
    withName: MYCC {
        ext.args   = "-t 3000 -meta"
    }
    withName: VAMB {
        ext.args   = "-m 3000"
        ext.args2   = "--minfasta 200000"
        ext.args3   = "-o C"
    }
    withName: METABAT2 {
        ext.args   = "--seed 42"
    }
    withName: JGI_SUMMARIZE_BAM_CONTIG_DEPTHS {
        ext.args   = ""
    }
    withName: MINIMAP2 {
        ext.args   = "-ax sr"
        ext.args2   = "-N 50"
    }
    withName: MMSEQS2_CREATEDB {
        ext.args   = ""
    }
    withName: MMSEQS2_CREATETAXDB {
        ext.args   = ""
    }
    withName: MMSEQS2_DATABASES {
        ext.args   = ""
    }
    withName: MMSEQS2_TAXONOMY {
        ext.args   = ""
    }
    withName: MMSEQS2_CREATETSV {
        ext.args   = ""
    }
}
